<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BICEPS: Fasta Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="/home/buote/programming/BICEPS/doc/doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">BICEPS
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">Fasta Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="Fasta" -->
<p><a href="class_fasta-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#aaf73cca67b785b51460db12b63fede50">Fasta</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#afc06b12dc4310ae26b8592f4b26d4e3e">clearTags</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a26fddee8437429872e969c3447402748">createFasta</a> (const bool mutated, const unsigned int tagsbegin, const unsigned int tagsend, const vector&lt; Tag &gt; &amp;tags, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a302f26cddc0d721cd67dfacf0c5c14a4">getMatches</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a318d21539427f22b4e89d85ab244bed1">getNumTags</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a8dc57bfae3796e4c46fce30705dfae96">initializeMGF</a> (unsigned int charge_, float precursorMass_)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a5437b8b75c11f12a134b64e3174ad090">loadBigFasta</a> (const std::string &amp;filename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a4d7beb2b13e130dde4eb62d3cd395997">loadTags</a> (const std::string &amp;tagstring, const vector&lt; float &gt; &amp;lowPeakMzs, vector&lt; Tag &gt; &amp;tags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee2fc75c1188b00bba72279b072243f5"></a><!-- doxytag: member="Fasta::matchSequences" ref="aee2fc75c1188b00bba72279b072243f5" args="(PepspliceResult &amp;pepresult, const std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>matchSequences</b> (PepspliceResult &amp;pepresult, const std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a47898073308dd318967b8b3a7c98552b">offerDescription</a> (unsigned int seqid) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a4d912b532afd909897c4d5640027896f">printTags</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a9d536a537486ee497323c1c4bb6bea14">setNumTags</a> (unsigned int numTags_)</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#af219299ebad47daa6631415a8b41345a">debuglevel</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a2e0aad28e3078b74e13b692c93b18962">outfile</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a2692497a73250708637b02675e67801f">calcWeight</a> (const string &amp;tag) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a55baa928744fbaed6709c0cc7c17f976">convAAToIndex</a> (const char AA) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a28beaa5daa69edf7bccbe29d76be64cd">convAAToMass</a> (const char AA) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#ad8e7e63ca6d92cbe69e31293e05b58fe">cTI2</a> (const string &amp;tag, const bool begin) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a5e688410dcca58ce94303f0adf4dfbbb">cutSequence</a> (const Tag &amp;tag, const unsigned int sequence_id, const unsigned int posTag, const int mutated, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a87bd2eb60377e57a0d3242fc9946c8bc">expandTag</a> (string tag, const size_t pos1, const vector&lt; float &gt; &amp;lowPeakMzs, const size_t pos2, vector&lt; Tag &gt; &amp;tags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#af1dbd88d309b35a641a45d484bdd15a6">findMutatedTags2</a> (const unsigned int tagsbegin, const unsigned int tagsend, const vector&lt; Tag &gt; &amp;tags, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a1215578a1b43eeb14cb16d3a2e5c2515">findTags2</a> (const unsigned int tagsbegin, const unsigned int tagsend, const vector&lt; Tag &gt; &amp;tags, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#aa36ba369d9df28bbea6ee9bff6d268f2">indexFasta</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a1e88836e5382e4a802262cd2561b9b10">push_Tag</a> (const string &amp;tag, const vector&lt; float &gt; &amp;lowPeakMzs, int index, vector&lt; Tag &gt; &amp;tags)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad5b54bbd582488ca241118a5f9b0aefc"></a><!-- doxytag: member="Fasta::aveAAweight" ref="ad5b54bbd582488ca241118a5f9b0aefc" args="" -->
float&#160;</td><td class="memItemRight" valign="bottom"><b>aveAAweight</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a8d33d804b995a1b5463ba663a171f790">bigfasta</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a6c9c0a28c104f7b5bebf51c61d4a2332">bigfasta_descriptions</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32676d869853024c5d44d1a706607e00"></a><!-- doxytag: member="Fasta::charge" ref="a32676d869853024c5d44d1a706607e00" args="" -->
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>charge</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2552ca3cd468fbf0d85493255b937304"></a><!-- doxytag: member="Fasta::currentprotein" ref="a2552ca3cd468fbf0d85493255b937304" args="" -->
string&#160;</td><td class="memItemRight" valign="bottom"><b>currentprotein</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; Tag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a30bb28a0935de5025c0b0213535f6737">directags</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; vector<br class="typebreak"/>
&lt; unsigned int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#aadb47ffbc7213fc2109b376fd0c50824">doubleIndices</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a82bc6fb87444e0c7a665ad8c5ec903e9">matches</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a3e2a16e720886ee50927f6c3202da325">numTags</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; Tag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#a70b8260a2ca7f1eb96caa6afd151a53f">pepntags</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa46fd9a18888c140426844e335dac71e"></a><!-- doxytag: member="Fasta::precursorMassCharged" ref="aa46fd9a18888c140426844e335dac71e" args="" -->
float&#160;</td><td class="memItemRight" valign="bottom"><b>precursorMassCharged</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fasta.html#ae52505333d9f6dd725fbc38c9e92abb8">tagLength</a></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aae8c121f339e490c77cea5d81206553f"></a><!-- doxytag: member="Fasta::Biceps" ref="aae8c121f339e490c77cea5d81206553f" args="" -->
class&#160;</td><td class="memItemRight" valign="bottom"><b>Biceps</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class encapsulates all functions to deal with a fasta database. </p>
<p><a class="el" href="class_fasta.html" title="This class encapsulates all functions to deal with a fasta database.">Fasta</a> class This is a class for dealing with fasta-databases, like ipi.BOVIN.fasta. Searching: Given Tags, which should be of the Tag class (with length of 5), this class is able to search for matching subsequences in the database. While it is possible to only aim for identical sequences, mutations can also be considered. To provide this functionality, the complete Database has to be preloaded by the <code>loadBigFasta(cstring)</code> method, which will also parse and hash it. This enables us to search for the beginnings of the tags in the created hash-table, which should speed up the search as most of the sequences can be ignored. Considering mutated tags, valid hits consist of subsequences in the database which differ from the provided tags by less than 2 AAs. As actually creating all different mutations and searching for them in the database is very time-consuming, an approach is chosen where it's possible that 1 compare between the tag and the subsequence may fail, though this is only possible if we use a hash table to actually match either the beginning or the ending of a tag to the subsequence first.</p>
<p>Creating: Pepsplice, another library which is used in the BICEPS program, needs fasta-databases to find AA-sequences. As generic databases are too big to provide results in a reasonable time, a smaller customized one is more viable and will thus be created by the <code>createFasta</code>-method. The result, a <code>std::vector&lt;std::tuple&lt;unsigned int, std::string, std::string&gt; &gt;</code> containing modified and unmodified subsequences can then be processed by pepsplice.</p>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">Output</td><td>will be a fasta std::vector&lt;std::tuple&lt;unsigned int, std::string, std::string&gt; &gt; in the &lt;mutated tagstring, original tagstring&gt; format.</td></tr>
  </table>
  </dd>
</dl>
<p>Example Usage: </p>
<div class="fragment"><pre class="fragment"> vector&lt;Tag&gt; tagbuffer;
 std::vector&lt;std::tuple&lt;unsigned int, std::string, std::string&gt; &gt; pepnFasta;

 <a class="code" href="class_fasta.html" title="This class encapsulates all functions to deal with a fasta database.">Fasta</a> fasta;
 fasta.<a class="code" href="class_fasta.html#a5437b8b75c11f12a134b64e3174ad090" title="loadBigFasta needs the filename (as a std::string) of the fastafile, it will then call some private f...">loadBigFasta</a>(<span class="stringliteral">&quot;ipi.CHICK.fasta&quot;</span>);
 fasta.<a class="code" href="class_fasta.html#a4d7beb2b13e130dde4eb62d3cd395997" title="This method takes the unmodified tagstring, changes the L AAs to I for performance reasons and fills ...">loadTags</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;AAAAA&quot;</span>), lowPeakMzs, tagbuffer);
 fasta.<a class="code" href="class_fasta.html#a26fddee8437429872e969c3447402748" title="createFasta will search for (partial, depending on the mutated parameter) matches of the tags compare...">createFasta</a>(1,0,0, tagbuffer, pepnFasta);
</pre></div> 
<p>Definition at line <a class="el" href="fasta_8h_source.html#l00088">88</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaf73cca67b785b51460db12b63fede50"></a><!-- doxytag: member="Fasta::Fasta" ref="aaf73cca67b785b51460db12b63fede50" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_fasta.html">Fasta</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The Default Constructor just initializes numOfTags to 20 and averageAAWeight to 111.0, which is used for heuristic expanding of the tag. </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00023">23</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2692497a73250708637b02675e67801f"></a><!-- doxytag: member="Fasta::calcWeight" ref="a2692497a73250708637b02675e67801f" args="(const string &amp;tag) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float <a class="el" href="class_fasta.html#a2692497a73250708637b02675e67801f">calcWeight</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>tag</em></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate the sum of the AA-weights in the tag </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00162">162</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8cpp_source.html#l00027">convAAToMass()</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00129">push_Tag()</a>.</p>

</div>
</div>
<a class="anchor" id="afc06b12dc4310ae26b8592f4b26d4e3e"></a><!-- doxytag: member="Fasta::clearTags" ref="afc06b12dc4310ae26b8592f4b26d4e3e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#afc06b12dc4310ae26b8592f4b26d4e3e">clearTags</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>clear all tags </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00145">145</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00418">Biceps::run_programs()</a>.</p>

</div>
</div>
<a class="anchor" id="a55baa928744fbaed6709c0cc7c17f976"></a><!-- doxytag: member="Fasta::convAAToIndex" ref="a55baa928744fbaed6709c0cc7c17f976" args="(const char AA) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#a55baa928744fbaed6709c0cc7c17f976">convAAToIndex</a> </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>AA</em></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>switch-case for getting index of specific AA for indexFasta, should be fastest solution with jump-table </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00057">57</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00153">cTI2()</a>, and <a class="el" href="fasta_8cpp_source.html#l00251">indexFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="a28beaa5daa69edf7bccbe29d76be64cd"></a><!-- doxytag: member="Fasta::convAAToMass" ref="a28beaa5daa69edf7bccbe29d76be64cd" args="(const char AA) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_fasta.html#a28beaa5daa69edf7bccbe29d76be64cd">convAAToMass</a> </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>AA</em></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>switch-case for getting the mass of a specific AA, should be fastest solution with jump-table </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00027">27</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00162">calcWeight()</a>, and <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>.</p>

</div>
</div>
<a class="anchor" id="a26fddee8437429872e969c3447402748"></a><!-- doxytag: member="Fasta::createFasta" ref="a26fddee8437429872e969c3447402748" args="(const bool mutated, const unsigned int tagsbegin, const unsigned int tagsend, const vector&lt; Tag &gt; &amp;tags, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a26fddee8437429872e969c3447402748">createFasta</a> </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>mutated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tagsbegin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tagsend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; Tag &gt; &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>currentFasta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>createFasta will search for (partial, depending on the mutated parameter) matches of the tags compared to the previously loaded fasta. tagsbegin and tagsend limit the indices of the searched tags, results will be written into the given currentFasta. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mutated</td><td>boolean, sets if mutated tags should also be used for the matching algorithm </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagsbegin</td><td>sets the first tag that should be used to search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagsend</td><td>use up to tagsend - 1th tag to search for matches </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>the tag-vector containing the tags to search for </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currentFasta</td><td>this will save all the matching-results </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00173">173</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00239">debuglevel</a>, <a class="el" href="fasta_8cpp_source.html#l00397">findMutatedTags2()</a>, <a class="el" href="fasta_8cpp_source.html#l00340">findTags2()</a>, <a class="el" href="fasta_8h_source.html#l00243">matches</a>, and <a class="el" href="fasta_8h_source.html#l00237">outfile</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00542">Biceps::runPepsplice()</a>.</p>

</div>
</div>
<a class="anchor" id="ad8e7e63ca6d92cbe69e31293e05b58fe"></a><!-- doxytag: member="Fasta::cTI2" ref="ad8e7e63ca6d92cbe69e31293e05b58fe" args="(const string &amp;tag, const bool begin) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#ad8e7e63ca6d92cbe69e31293e05b58fe">cTI2</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>begin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculating the index of a Tag, if begin ==1 it uses the first two AAs, otherwise it's the last two, helper function to search faster for tags.</p>
<p>Returns the hash value of the string, using trivial hash with 19 * tag[0] + tag[1] here Probably has to be enhanced when looking at tagsize &gt; 5 Very hardcoded, but fast! </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>the string-portion of the tag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">begin</td><td>if true, get the hash for the pair of tag[0], tag[1], if false return the hash of tag[3] tag[4] </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">hash-value</td><td>of a pair of chars </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00153">153</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8cpp_source.html#l00057">convAAToIndex()</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00397">findMutatedTags2()</a>, and <a class="el" href="fasta_8cpp_source.html#l00340">findTags2()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e688410dcca58ce94303f0adf4dfbbb"></a><!-- doxytag: member="Fasta::cutSequence" ref="a5e688410dcca58ce94303f0adf4dfbbb" args="(const Tag &amp;tag, const unsigned int sequence_id, const unsigned int posTag, const int mutated, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="class_fasta.html#a5e688410dcca58ce94303f0adf4dfbbb">cutSequence</a> </td>
          <td>(</td>
          <td class="paramtype">const Tag &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>sequence_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>posTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mutated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>currentFasta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>As we don't want to put whole sequences into the new fasta-database, only short sequences containing the Tag will be added to currentFasta, also return the mutated shortSequence. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>the tag which is matched against the fasta-entry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sequence_id</td><td>the number of the sequence in the fasta-database </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">posTag</td><td>the beginning of the (mutated) match between entry and tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mutated</td><td>the boolean deciding whether mutations should be considered </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currentFasta</td><td>this will save all the matching-results </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>mutated substring which matches the tag, with padding on both sides and with optional mutations </td></tr>
  </table>
  </dd>
</dl>
<p>This index-list will save the occurence of the tag in the original fasta. </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00275">275</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00245">bigfasta</a>, <a class="el" href="fasta_8cpp_source.html#l00027">convAAToMass()</a>, <a class="el" href="fasta_8h_source.html#l00239">debuglevel</a>, <a class="el" href="fasta_8h_source.html#l00237">outfile</a>, and <a class="el" href="fasta_8h_source.html#l00256">tagLength</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00397">findMutatedTags2()</a>, and <a class="el" href="fasta_8cpp_source.html#l00340">findTags2()</a>.</p>

</div>
</div>
<a class="anchor" id="a87bd2eb60377e57a0d3242fc9946c8bc"></a><!-- doxytag: member="Fasta::expandTag" ref="a87bd2eb60377e57a0d3242fc9946c8bc" args="(string tag, const size_t pos1, const vector&lt; float &gt; &amp;lowPeakMzs, const size_t pos2, vector&lt; Tag &gt; &amp;tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a87bd2eb60377e57a0d3242fc9946c8bc">expandTag</a> </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>pos1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowPeakMzs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>pos2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Tag &gt; &amp;&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>helper function, because pepnovo/directag don't differentiate between I and L, the other tags have to be generated hereby </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>the string of the expanded tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos1</td><td>the current letter to be expanded, will only expand if it's I or L </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowPeakMzs</td><td>a vector with the Peakvalues, gotten from directag or pepnovo </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>the vector to write the results into </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00106">106</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8cpp_source.html#l00129">push_Tag()</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00087">loadTags()</a>.</p>

</div>
</div>
<a class="anchor" id="af1dbd88d309b35a641a45d484bdd15a6"></a><!-- doxytag: member="Fasta::findMutatedTags2" ref="af1dbd88d309b35a641a45d484bdd15a6" args="(const unsigned int tagsbegin, const unsigned int tagsend, const vector&lt; Tag &gt; &amp;tags, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#af1dbd88d309b35a641a45d484bdd15a6">findMutatedTags2</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tagsbegin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tagsend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; Tag &gt; &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>currentFasta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>this function searches for partial matches (up to 1 differing AA) between given tags and the previously loaded <a class="el" href="class_fasta.html" title="This class encapsulates all functions to deal with a fasta database.">Fasta</a>. A speedup was possible via hashing all sequences and searching for parts of a given tag. very hardcoded, works only for size-5 tags, using the index and 'jumping' over the mutated parts. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tagsbegin</td><td>the index of the first tag to search for </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagsend</td><td>index+1 of the last tag to search for </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>the tag-vector to search for </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currentFasta</td><td>this will save all the matching-results </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00397">397</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00245">bigfasta</a>, <a class="el" href="fasta_8cpp_source.html#l00153">cTI2()</a>, <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>, <a class="el" href="fasta_8h_source.html#l00270">doubleIndices</a>, and <a class="el" href="fasta_8h_source.html#l00243">matches</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00173">createFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="a1215578a1b43eeb14cb16d3a2e5c2515"></a><!-- doxytag: member="Fasta::findTags2" ref="a1215578a1b43eeb14cb16d3a2e5c2515" args="(const unsigned int tagsbegin, const unsigned int tagsend, const vector&lt; Tag &gt; &amp;tags, std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;currentFasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a1215578a1b43eeb14cb16d3a2e5c2515">findTags2</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tagsbegin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tagsend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; Tag &gt; &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; unsigned int, std::string, std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>currentFasta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>tagsbegin and tagsend limit the index of the used tags - we don't want to use all of them this find function will use a previously calculated index and the hashed sequences. the cut sequences will be written to currentFasta via cutSequence </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tagsbegin</td><td>the index of the first tag to search for </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagsend</td><td>index+1 of the last tag to search for </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>the tag-vector to search for </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">currentFasta</td><td>this will save all the matching-results </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00340">340</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00245">bigfasta</a>, <a class="el" href="fasta_8cpp_source.html#l00153">cTI2()</a>, <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>, <a class="el" href="fasta_8h_source.html#l00270">doubleIndices</a>, and <a class="el" href="fasta_8h_source.html#l00243">matches</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00173">createFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="a302f26cddc0d721cd67dfacf0c5c14a4"></a><!-- doxytag: member="Fasta::getMatches" ref="a302f26cddc0d721cd67dfacf0c5c14a4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#a302f26cddc0d721cd67dfacf0c5c14a4">getMatches</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>counts the number of matches btween tags and fasta </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00137">137</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00542">Biceps::runPepsplice()</a>.</p>

</div>
</div>
<a class="anchor" id="a318d21539427f22b4e89d85ab244bed1"></a><!-- doxytag: member="Fasta::getNumTags" ref="a318d21539427f22b4e89d85ab244bed1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#a318d21539427f22b4e89d85ab244bed1">getNumTags</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>public interface </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00148">148</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00418">Biceps::run_programs()</a>.</p>

</div>
</div>
<a class="anchor" id="aa36ba369d9df28bbea6ee9bff6d268f2"></a><!-- doxytag: member="Fasta::indexFasta" ref="aa36ba369d9df28bbea6ee9bff6d268f2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#aa36ba369d9df28bbea6ee9bff6d268f2">indexFasta</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>parse the complete fasta-database while indexing all occurences of all AA pairs for a quicker tag-search later </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00251">251</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00245">bigfasta</a>, <a class="el" href="fasta_8cpp_source.html#l00057">convAAToIndex()</a>, and <a class="el" href="fasta_8h_source.html#l00270">doubleIndices</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00194">loadBigFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="a8dc57bfae3796e4c46fce30705dfae96"></a><!-- doxytag: member="Fasta::initializeMGF" ref="a8dc57bfae3796e4c46fce30705dfae96" args="(unsigned int charge_, float precursorMass_)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a8dc57bfae3796e4c46fce30705dfae96">initializeMGF</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>charge_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>precursorMass_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initializeMGF sets the charge and the precursormass, it's used in the main function for every additional spectrum. the precursormass will be multiplicated with the charge and stored in the <a class="el" href="class_fasta.html" title="This class encapsulates all functions to deal with a fasta database.">Fasta</a> class </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00131">131</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00101">Biceps::readMGF()</a>.</p>

</div>
</div>
<a class="anchor" id="a5437b8b75c11f12a134b64e3174ad090"></a><!-- doxytag: member="Fasta::loadBigFasta" ref="a5437b8b75c11f12a134b64e3174ad090" args="(const std::string &amp;filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a5437b8b75c11f12a134b64e3174ad090">loadBigFasta</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>loadBigFasta needs the filename (as a std::string) of the fastafile, it will then call some private functions. </p>
<p>They will then create an easier to search fastafile with replaced I AAs, a hashing index containing all 2-combinations of AAs will also be made </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>of the fasta-database to index and match/search later, e.g. loadBigFasta(string("ipi.BOVIN.fasta")) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00194">194</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00245">bigfasta</a>, <a class="el" href="fasta_8h_source.html#l00249">bigfasta_descriptions</a>, and <a class="el" href="fasta_8cpp_source.html#l00251">indexFasta()</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00009">Biceps::initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d7beb2b13e130dde4eb62d3cd395997"></a><!-- doxytag: member="Fasta::loadTags" ref="a4d7beb2b13e130dde4eb62d3cd395997" args="(const std::string &amp;tagstring, const vector&lt; float &gt; &amp;lowPeakMzs, vector&lt; Tag &gt; &amp;tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_fasta.html#a4d7beb2b13e130dde4eb62d3cd395997">loadTags</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>tagstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowPeakMzs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Tag &gt; &amp;&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This method takes the unmodified tagstring, changes the L AAs to I for performance reasons and fills the internal tag vectors for further processing. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tagstring</td><td>string which is made up of the different tags found by pepnovo/directag, no spaces. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowPeakMzs</td><td>is also calculated by pepnovo/directag, it has to be multiplicated by the spectrum charge-1 to calculate the mass. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>number of tags found/created + 1 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00087">87</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8cpp_source.html#l00106">expandTag()</a>, and <a class="el" href="fasta_8h_source.html#l00256">tagLength</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00418">Biceps::run_programs()</a>.</p>

</div>
</div>
<a class="anchor" id="a47898073308dd318967b8b3a7c98552b"></a><!-- doxytag: member="Fasta::offerDescription" ref="a47898073308dd318967b8b3a7c98552b" args="(unsigned int seqid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="class_fasta.html#a47898073308dd318967b8b3a7c98552b">offerDescription</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>seqid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>insert id, get the description in the fastafile for that specific id. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seqid</td><td>id of the spectrum you want the information for </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>the description of that specific spectrum taken from the fasta file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00142">142</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00604">Biceps::writeResult()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d912b532afd909897c4d5640027896f"></a><!-- doxytag: member="Fasta::printTags" ref="a4d912b532afd909897c4d5640027896f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a4d912b532afd909897c4d5640027896f">printTags</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>just print all of the currently saved tags in the fasta class, this will be pepnTags and direcTags </p>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00135">135</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8h_source.html#l00251">directags</a>, and <a class="el" href="fasta_8h_source.html#l00253">pepntags</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00418">Biceps::run_programs()</a>.</p>

</div>
</div>
<a class="anchor" id="a1e88836e5382e4a802262cd2561b9b10"></a><!-- doxytag: member="Fasta::push_Tag" ref="a1e88836e5382e4a802262cd2561b9b10" args="(const string &amp;tag, const vector&lt; float &gt; &amp;lowPeakMzs, int index, vector&lt; Tag &gt; &amp;tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a1e88836e5382e4a802262cd2561b9b10">push_Tag</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowPeakMzs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Tag &gt; &amp;&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>nothing special, just a short way to add to the tags </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>the string of the to be saved tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowPeakMzs</td><td>a vector with the Peakvalues, gotten from directag or pepnovo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>the index of the corresponding peakvalue in lowPeakMzs </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>the vector to write the results into </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fasta_8cpp_source.html#l00129">129</a> of file <a class="el" href="fasta_8cpp_source.html">fasta.cpp</a>.</p>

<p>References <a class="el" href="fasta_8cpp_source.html#l00162">calcWeight()</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00106">expandTag()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d536a537486ee497323c1c4bb6bea14"></a><!-- doxytag: member="Fasta::setNumTags" ref="a9d536a537486ee497323c1c4bb6bea14" args="(unsigned int numTags_)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_fasta.html#a9d536a537486ee497323c1c4bb6bea14">setNumTags</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>numTags_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>change the limit of saved tags, default is 20 per directag/pepnovo program. </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00134">134</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="biceps_8cpp_source.html#l00101">Biceps::readMGF()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a8d33d804b995a1b5463ba663a171f790"></a><!-- doxytag: member="Fasta::bigfasta" ref="a8d33d804b995a1b5463ba663a171f790" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;string&gt; <a class="el" href="class_fasta.html#a8d33d804b995a1b5463ba663a171f790">bigfasta</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>indexed fasta file </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00245">245</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>, <a class="el" href="fasta_8cpp_source.html#l00397">findMutatedTags2()</a>, <a class="el" href="fasta_8cpp_source.html#l00340">findTags2()</a>, <a class="el" href="fasta_8cpp_source.html#l00251">indexFasta()</a>, <a class="el" href="fasta_8cpp_source.html#l00194">loadBigFasta()</a>, and <a class="el" href="biceps_8cpp_source.html#l00368">Biceps::writeFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="a6c9c0a28c104f7b5bebf51c61d4a2332"></a><!-- doxytag: member="Fasta::bigfasta_descriptions" ref="a6c9c0a28c104f7b5bebf51c61d4a2332" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;string&gt; <a class="el" href="class_fasta.html#a6c9c0a28c104f7b5bebf51c61d4a2332">bigfasta_descriptions</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>descriptions for later output </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00249">249</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00194">loadBigFasta()</a>, and <a class="el" href="biceps_8cpp_source.html#l00368">Biceps::writeFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="af219299ebad47daa6631415a8b41345a"></a><!-- doxytag: member="Fasta::debuglevel" ref="af219299ebad47daa6631415a8b41345a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_fasta.html#af219299ebad47daa6631415a8b41345a">debuglevel</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>change the debug level, 1 is default. Higher debuglevels will provide file-logging. </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00239">239</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00173">createFasta()</a>, <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>, and <a class="el" href="biceps_8cpp_source.html#l00009">Biceps::initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a30bb28a0935de5025c0b0213535f6737"></a><!-- doxytag: member="Fasta::directags" ref="a30bb28a0935de5025c0b0213535f6737" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;Tag&gt; <a class="el" href="class_fasta.html#a30bb28a0935de5025c0b0213535f6737">directags</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the tags from directag, which are produced by <a class="el" href="class_fasta.html#a4d7beb2b13e130dde4eb62d3cd395997" title="This method takes the unmodified tagstring, changes the L AAs to I for performance reasons and fills ...">loadTags()</a> </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00251">251</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00135">printTags()</a>, <a class="el" href="biceps_8cpp_source.html#l00418">Biceps::run_programs()</a>, and <a class="el" href="biceps_8cpp_source.html#l00542">Biceps::runPepsplice()</a>.</p>

</div>
</div>
<a class="anchor" id="aadb47ffbc7213fc2109b376fd0c50824"></a><!-- doxytag: member="Fasta::doubleIndices" ref="aadb47ffbc7213fc2109b376fd0c50824" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;vector&lt;vector&lt;unsigned int&gt; &gt; &gt; <a class="el" href="class_fasta.html#aadb47ffbc7213fc2109b376fd0c50824">doubleIndices</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Indexing all Tags with 2 AAs, for easier/faster search later It's a pretty ugly triple-vector, access is done via doubleIndices[SequenceID][hash_of_pair][entry];. </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00270">270</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00397">findMutatedTags2()</a>, <a class="el" href="fasta_8cpp_source.html#l00340">findTags2()</a>, and <a class="el" href="fasta_8cpp_source.html#l00251">indexFasta()</a>.</p>

</div>
</div>
<a class="anchor" id="a82bc6fb87444e0c7a665ad8c5ec903e9"></a><!-- doxytag: member="Fasta::matches" ref="a82bc6fb87444e0c7a665ad8c5ec903e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#a82bc6fb87444e0c7a665ad8c5ec903e9">matches</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>number of matches </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00243">243</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00173">createFasta()</a>, <a class="el" href="fasta_8cpp_source.html#l00397">findMutatedTags2()</a>, and <a class="el" href="fasta_8cpp_source.html#l00340">findTags2()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e2a16e720886ee50927f6c3202da325"></a><!-- doxytag: member="Fasta::numTags" ref="a3e2a16e720886ee50927f6c3202da325" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#a3e2a16e720886ee50927f6c3202da325">numTags</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>number of tags </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00259">259</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2e0aad28e3078b74e13b692c93b18962"></a><!-- doxytag: member="Fasta::outfile" ref="a2e0aad28e3078b74e13b692c93b18962" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream <a class="el" href="class_fasta.html#a2e0aad28e3078b74e13b692c93b18962">outfile</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>if Debugoutput is needed, outfile will be used for saving the resulting fasta-database. </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00237">237</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00173">createFasta()</a>, and <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>.</p>

</div>
</div>
<a class="anchor" id="a70b8260a2ca7f1eb96caa6afd151a53f"></a><!-- doxytag: member="Fasta::pepntags" ref="a70b8260a2ca7f1eb96caa6afd151a53f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;Tag&gt; <a class="el" href="class_fasta.html#a70b8260a2ca7f1eb96caa6afd151a53f">pepntags</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the tags from pepnovo, which are produced by <a class="el" href="class_fasta.html#a4d7beb2b13e130dde4eb62d3cd395997" title="This method takes the unmodified tagstring, changes the L AAs to I for performance reasons and fills ...">loadTags()</a> </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00253">253</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00135">printTags()</a>, <a class="el" href="biceps_8cpp_source.html#l00418">Biceps::run_programs()</a>, and <a class="el" href="biceps_8cpp_source.html#l00542">Biceps::runPepsplice()</a>.</p>

</div>
</div>
<a class="anchor" id="ae52505333d9f6dd725fbc38c9e92abb8"></a><!-- doxytag: member="Fasta::tagLength" ref="ae52505333d9f6dd725fbc38c9e92abb8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_fasta.html#ae52505333d9f6dd725fbc38c9e92abb8">tagLength</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>not used at the moment, as the hardcoded tagLength is 5 for performance reasons. </p>

<p>Definition at line <a class="el" href="fasta_8h_source.html#l00256">256</a> of file <a class="el" href="fasta_8h_source.html">fasta.h</a>.</p>

<p>Referenced by <a class="el" href="fasta_8cpp_source.html#l00275">cutSequence()</a>, and <a class="el" href="fasta_8cpp_source.html#l00087">loadTags()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="fasta_8h_source.html">fasta.h</a></li>
<li><a class="el" href="fasta_8cpp_source.html">fasta.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 10 2012 17:29:17 for BICEPS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
